dist: trusty
language: python
env:
  - BACKEND_DIR='backend/src' FRONTEND_DIR='web/app' CI='true'

python:
  - "3.6"

addons:
  sonarcloud:
    organization: "borisv13-github" # the key of the org you chose at step #3
    token:
      secure: $SONAR_TOKEN # encrypted value of your token

install:
  - pip install -r $BACKEND_DIR/main/requirements.txt
  - pip install -r $BACKEND_DIR/test/requirements.txt
  - npm --prefix $FRONTEND_DIR install

before_script:
  - pylint $BACKEND_DIR/

script:
  - pytest --cov-report term --cov=.
  - coverage xml
  - npm --prefix $FRONTEND_DIR test
  - sonar-scanner

after_script:
  - codecov

# safelist
branches:
  only:
    - master
